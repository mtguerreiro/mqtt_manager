
//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
#include "task_svmqtt.h"

#include "stdlib.h"

/* Kernel */
#include "FreeRTOS.h"
#include "task.h"

/* SVMQTT */
#include "mqttmng.h"
#include "mqttmngConfig.h"
//=============================================================================

//=============================================================================
/*--------------------------------- Defines ---------------------------------*/
//=============================================================================

//=============================================================================

//=============================================================================
/*--------------------------------- Globals ---------------------------------*/
//=============================================================================
static int32_t svmqttStatus = 1;
//=============================================================================

//=============================================================================
/*-------------------------------- Prototypes -------------------------------*/
//=============================================================================
static int32_t taskSvqmttInit(void);
//=============================================================================

//=============================================================================
/*---------------------------------- Task -----------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
void taskSvmqtt(void *param){

    printf("Initializing SVMQTT...\n\r");

    if( taskSvqmttInit() != 0 ) exit (-1);

    printf("SVMQTT initialized.\n\r");

    svmqttStatus = 0;

    while(1){
        mqttmngRun();
    }
}
//-----------------------------------------------------------------------------
int32_t taskSvmqttStatus(void){

    return svmqttStatus;
}
//-----------------------------------------------------------------------------
//=============================================================================

//=============================================================================
/*---------------------------- Static functions -----------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
static int32_t taskSvqmttInit(void){
    
    int32_t status;

    status = mqttmngInit();
 	mqttmngAddComponent(MQTT_MNG_COMP_1, (const char*)"temp1", (const char*)"temperature", (const char*)0);
	mqttmngAddComponent(MQTT_MNG_COMP_2, (const char*)"led233", (const char*)"led", (const char*)"ri");

    return status;
}
//-----------------------------------------------------------------------------
//=============================================================================
