
//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
#include "task_blink.h"

#include "stdio.h"
#include "stddef.h"
#include "time.h"

#include "loggingConfig.h"
//=============================================================================

//=============================================================================
/*--------------------------------- Defines ---------------------------------*/
//=============================================================================
#define TASK_BLINK_CONFIG_PERIOD_MS    (3000)
//=============================================================================

//=============================================================================
/*--------------------------------- Globals ---------------------------------*/
//=============================================================================
static struct timespec t;
//=============================================================================

//=============================================================================
/*-------------------------------- Prototypes -------------------------------*/
//=============================================================================
static void taskBlinkInitialize(void);
//=============================================================================

//=============================================================================
/*---------------------------------- Task -----------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
void* taskBlink(void *param){

    (void)param;
    taskBlinkInitialize();

    while(1){
        nanosleep(&t, NULL);
        LogInfo( ("Blink") );
    }
}
//-----------------------------------------------------------------------------
//=============================================================================

//=============================================================================
/*---------------------------- Static functions -----------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
static void taskBlinkInitialize(void){

    t.tv_sec = (TASK_BLINK_CONFIG_PERIOD_MS) / 1000;
    t.tv_nsec = (TASK_BLINK_CONFIG_PERIOD_MS) * 1000000U - t.tv_sec * 1000000000U;

    LogInfo( ("Running blink task with. Timespec: %lu (s), %lu (ns).", t.tv_sec, t.tv_nsec) );
}
//-----------------------------------------------------------------------------
//=============================================================================
