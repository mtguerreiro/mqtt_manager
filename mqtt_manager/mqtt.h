#ifndef MQTT_H_
#define MQTT_H_

//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
#include "stdint.h"
#include "stddef.h"

#include "core_mqtt.h"
//============================================================================

//=============================================================================
/*------------------------------- Definitions -------------------------------*/
//=============================================================================
typedef void (* mqttSubscrCb_t )( MQTTContext_t * pContext, MQTTPublishInfo_t * pPublishInfo );

typedef int32_t (*mqttLock_t)(uint32_t timeout);
typedef void (*mqttUnlock_t)(void);

typedef struct
{
    uint8_t retain;
    uint8_t dup;
    const void * data;
    uint32_t size;
}mqttPayload_t;
//=============================================================================

//=============================================================================
/*-------------------------------- Functions --------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
int32_t mqttInit(
    const char *clientId, MQTTPublishInfo_t *lastWillInfo,
    mqttLock_t lock, mqttUnlock_t unlock
);
//-----------------------------------------------------------------------------
void mqttRun(uint32_t forever);
//-----------------------------------------------------------------------------
int32_t mqttPublishComponent(const char *name, const char *type, const char *flags);
//-----------------------------------------------------------------------------
int32_t mqttPublish(const char *topic, mqttPayload_t *payload);
//-----------------------------------------------------------------------------
int32_t mqttSubscribe(const char *topic, mqttSubscrCb_t callback);
//-----------------------------------------------------------------------------
int mqttInitDone(void);
//-----------------------------------------------------------------------------
//=============================================================================

#endif /* MQTT_H_ */
