
//=============================================================================
/*-------------------------------- Includes ---------------------------------*/
//=============================================================================
/* Device and drivers */
#include "pico/cyw43_arch.h"
#include "pico/stdlib.h"

/* FreeRTOS */
#include "FreeRTOS.h"
#include "task.h"

/* Tasks */
#include "tasks/task_blink.h"
#include "tasks/task_temperature.h"
#include "tasks/task_led.h"
#include "tasks/task_wifi_init.h"

#include "mhw/pico/pwm_irq_handler.h"
//=============================================================================

//=============================================================================
/*--------------------------------- Defines ---------------------------------*/
//=============================================================================

//=============================================================================

//=============================================================================
/*-------------------------------- Prototypes -------------------------------*/
//=============================================================================
static int mainSysInit(void);
//=============================================================================

//=============================================================================
/*--------------------------------- Globals ---------------------------------*/
//=============================================================================

//=============================================================================

//=============================================================================
/*---------------------------------- Main -----------------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
int main(void)
{
    if( mainSysInit() != 0 ) exit (-1);

    printf("Starting FreeRTOS...\n\r");

    xTaskCreate(
        taskWifiInit,                           /* Function that implements the task. */
        "wifi-init",                            /* Text name for the task. */
        TASK_WIFI_INIT_CONFIG_TASK_STACK_SIZE,  /* Stack size in words, not bytes. */
        NULL,                                   /* Parameter passed into the task. */
        TASK_WIFI_INIT_CONFIG_TASK_PRIO,        /* Priority at which the task is created. */
        NULL );                                 /* Used to pass out the created task's handle. */

    printf("Running FreeRTOS...\n\r");
    vTaskStartScheduler();
}
//-----------------------------------------------------------------------------
//=============================================================================

//=============================================================================
/*---------------------------- Static functions -----------------------------*/
//=============================================================================
//-----------------------------------------------------------------------------
static int mainSysInit(void){

    stdio_init_all();

    pwmIrqHandlerInitialize(PICO_DEFAULT_IRQ_PRIORITY);

    return 0;
}
//-----------------------------------------------------------------------------
//=============================================================================
